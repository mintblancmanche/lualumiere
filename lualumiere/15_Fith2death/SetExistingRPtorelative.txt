
local side = ScenEdit_PlayerSide()
local selected = ScenEdit_SelectedUnits()
if selected == nil then
  ScenEdit_MsgBox("Aborted: Please select unit or contact!", 0)
  return
end

local dir = tonumber( ScenEdit_InputBox("Enter direction of box.") )
if dir == nil then
  print("Cancelled.")
  return
end

unit = ScenEdit_GetUnit({guid = selected.units[1].guid})

local point1 = World_GetPointFromBearing ({latitude = unit.latitude, longitude = unit.longitude, bearing = dir, distance = 7.5})

local rp1 = World_GetPointFromBearing ({latitude = point1.latitude, longitude = point1.longitude, bearing = 270+dir, distance = 15})
local rp2 = World_GetPointFromBearing ({latitude = point1.latitude, longitude = point1.longitude, bearing = 90+dir, distance = 15})
local rp3 = World_GetPointFromBearing ({latitude = rp2.latitude, longitude = rp2.longitude, bearing = 180+dir, distance = 15})
local rp4 = World_GetPointFromBearing ({latitude = rp1.latitude, longitude = rp1.longitude, bearing = 180+dir, distance = 15})

local rp1brg = Tool_Bearing(unit.guid, {latitude = rp1.latitude, longitude = rp1.longitude})
local rp2brg = Tool_Bearing(unit.guid, {latitude = rp2.latitude, longitude = rp2.longitude})
local rp3brg = Tool_Bearing(unit.guid, {latitude = rp3.latitude, longitude = rp3.longitude})
local rp4brg = Tool_Bearing(unit.guid, {latitude = rp4.latitude, longitude = rp4.longitude})
local rp1dis = Tool_Range(unit.guid, {latitude = rp1.latitude, longitude = rp1.longitude})
local rp2dis = Tool_Range(unit.guid, {latitude = rp2.latitude, longitude = rp2.longitude})
local rp3dis = Tool_Range(unit.guid, {latitude = rp3.latitude, longitude = rp3.longitude})
local rp4dis = Tool_Range(unit.guid, {latitude = rp4.latitude, longitude = rp4.longitude})

local rp1 = World_GetPointFromBearing ({latitude = unit.latitude, longitude = unit.longitude, bearing=rp1brg, distance=rp1dis})
local rp2 = World_GetPointFromBearing ({latitude = unit.latitude, longitude = unit.longitude, bearing=rp2brg, distance=rp2dis)
local rp3 = World_GetPointFromBearing ({latitude = unit.latitude, longitude = unit.longitude, bearing=rp3brg, distance=rp3dis})
local rp4 = World_GetPointFromBearing ({latitude = unit.latitude, longitude = unit.longitude, bearing=rp4brg, distance=rp4dis})



ScenEdit_SetReferencePoint({side=side, name = "Tld-1", latitude = rp1.latitude, longitude = rp1.longitude})
ScenEdit_SetReferencePoint({side=side, name = "Tld-2", latitude = rp2.latitude, longitude = rp2.longitude})
ScenEdit_SetReferencePoint({side=side, name = "Tld-3", latitude = rp3.latitude, longitude = rp3.longitude})
ScenEdit_SetReferencePoint({side=side, name = "Tld-4", latitude = rp4.latitude, longitude = rp4.longitude})